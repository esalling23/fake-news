{{!< default}}
{{!-- 
/**
 * Uncertainty Project
 * Developed by Engagement Lab, 2016
 * ==============
 * 
 * Script include for global logic
 * ==========
 */
--}}


var event;
var gameId = '{{gameId}}';
var bottom;
var commentStack;
var commentFalling;

$(document).on('event:comments', function() {

	$('#post-feed').css('bottom', $('.feed-wrap').height);
	$('#post-feed').css('height', $('.post').length*300 + 'px');

	var bottom = 0;

	_.each($('.post'), function(post){

		$(post).css('bottom', bottom);
		bottom += 310;

	});

	// Call comments animation logic	
	StartCommentFeed();	

});

var StartCommentFeed = function(){

	console.log("startnig events");

	$('#post-feed').show();
    // To do : dymanic bottom size 

	var $items = $("#post-feed .post");
	$('#post-feed').animate({
	    bottom: '-1800px'
	}, 50000, 'linear', function() {

	  	console.log("round over");

	  	socket.emit('comments:end', { gameId: gameId, data: data });

	});

}

// Comment Logic

$('.post .share-btn').on('click', function(){

	if ($(this).parent().hasClass('shared')){

		return;

	} else {

		$(this).closest('.post').addClass('shared');
		$(this).prop("disabled",true);

		var data = {
			post: $(this).closest('.post').attr('id'),
			articles: eventData.data.articles, 
			profile: eventData.data.currentProfile
		};

		console.log(data);
		
		socket.emit('post:share', { gameId: gameId, data: data });
		
	}
	

});